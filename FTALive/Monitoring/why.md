# 1. 監視の意味と必要性 <!-- no toc -->

## 目次 <!-- omit in toc -->

- [1. 監視の意味と必要性](#1-監視の意味と必要性)
  - [1.1. なぜ監視が必要か](#11-なぜ監視が必要か)
  - [1.2. 監視の戦略を立てる](#12-監視の戦略を立てる)
  - [1.3. 監視するコンポーネントとその特徴、監視の方法](#13-監視するコンポーネントとその特徴監視の方法)
    - [アプリケーションの特性](#アプリケーションの特性)
    - [サーバー](#サーバー)
    - [ネットワーク](#ネットワーク)
    - [セキュリティ](#セキュリティ)

## 1.1. なぜ監視が必要か

クラウドやオンプレミス、利用しているサービスにかかわらず、システムを維持する上で監視は重要な要素の1つです。あらためてなぜ監視が必要かを考えてみましょう。

システムの設計から構築において、全体のアーキテクチャーを始めとして、ネットワークの経路やシステムの冗長化、アプリケーションの機能実装を検討する流れはよくあるシステム開発の手法です。それぞれのフェーズで、レビューやテストを実施することで、設計や機能的な不具合を検出することも一般的です。

同様に、システム運用のフェーズにおいても、システムが正しく動作しているか継続的な確認が必要です。システムはユーザー数の変化や設定変更、ハードウェアの経年劣化によって変化し続けています。また、一般的にシステムは複数のコンポーネントで構成されています。日々変化している複雑なシステムはもはや何が起こるか予測することは困難です。

運用フェーズにおいて継続的にシステムの動作をテスト=監視し、継続的にサービスを提供します。

監視の重要性と意味を理解し、効率的で効果的なシステム監視をしましょう。

## 1.2. 監視の戦略を立てる

多くのシステム設計では、監視設計として、監視対象のコンポーネントやそれぞれの監視項目、しきい値、アラートのトリガー条件を設計します。しかし、それらを設計する前に、監視戦略を立てることをお勧めします。

戦略がない監視は以下のような問題に直面することがあります。

- 障害が起きてから監視項目を追加する
- 監視ができていないサーバーが出てくる
- 監視ツールが多すぎる
- 監視ツールの制約によってできない(実装しにくい)監視がある
- 監視しかできない人がいる
- アラートを無視している
- サービスが停止していることに気付けない

監視の戦略は、ビジネスの視点で計画します。対象のシステムでどのような状態がビジネスとして正しい状態であるかを考えます。

以下は正しい状態の一例です。

- ユーザーがアプリケーションやサービスを利用できる状態である
- 利益が出せている状態である
- ユーザーの満足度が高い状態である

この正しい状態から、具体的な指標を決め、その指標をベースに監視の項目やアラートのトリガーを決定します。

以下は指標と指標から決定できる項目の一例です。

- ユーザーのログイン
  - ログインの失敗率
  - ログインまでの遅延時間
- アプリケーションの起動
  - 起動にかかる時間
- アプリケーションの使用
  - ファイルの保存にかかる時間
  - クラッシュ率
- 品物の購入
  - 購入の失敗率

これらの指標はシステムのアーキテクチャーやそのシステムを利用する組織・ユーザーによって大きく異なるため、それぞれのシステムで個別かつ具体的に検討する必要があります。この指標を決めるうえでベストプラクティスや汎用的に利用できるチェックリスト、指標等はありません。

## 1.3. 監視するコンポーネントとその特徴、監視の方法

監視戦略を計画したうえで、システムを構成するコンポーネントの特性を理解し、何を監視できるのかどのように監視すべきか監視の結果をどのようにとらえるかを考えます。

ここでは以下のカテゴリで説明します。

- アプリケーション
- サーバー
- ネットワーク
- セキュリティ

クラウドを利用している場合、これらのコンポーネントはクラウドプロバイダーによって管理されているケースがあります。しかしそれはあくまでも管理主体がクラウドプロバイダーとなるだけで、それぞれのサービスでサーバーやネットワーク等が利用されていないわけではありません。

クラウドを利用する場合であってもそれぞれの特性を理解することで監視設計に活かすことができます。

### アプリケーションの特性

アプリケーションは、大きく Web アプリケーションと 非 Web アプリケーションがあり、持っている特性や監視の方法も大きく異なります。ここでは、前提として Web アプリケーションを対象として説明しますが、非 Web アプリケーションであっても考え方は参考にできる部分があります。

Web アプリケーション は主に、フロントエンドとバックエンドで構成されています。

フロントエンドはユーザーのクライアントアプリケーションやクライアントのパフォーマンス、ネットワーク帯域によって大きく左右されます。たとえば、「ブラウザで Web ページを表示する」と一言で言っても、アプリケーションのリクエストの開始から始まり、名前解決、レスポンスまでの時間、DOM の表示開始から読み込み完了、JavaScript の実行等の処理が行われます。



### サーバー

### ネットワーク

### セキュリティ
